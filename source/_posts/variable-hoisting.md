---
title: 变量提升  
date: 2017-03-16 10:37:50  
categories: JS  
tags: web前端  
---

<blockquote class="blockquote-center">代码块中的变量为何还能被外部获取到？<br/>一直认为的for循环为何在循环体外也能获取？</blockquote>

__这就是所谓的变量提升，我一直存在的误区之一__

<!--more-->

相信大部分人士都明白变量提升是怎么一回事，包括我在学前端之际也明白，但是这只是局限性的，因为平时使用的for循环一直被灌输了这样一个理念： __两个 for 循环内部均可使用同一个变量 i 而且互不影响，正是因为 i 是局部变量。__

然而>>>
```javascript
for(var i = 0;i<3;i++){fn1...}
for(var i = 0;i<3;i++){fn2...}
console.log(i)//依旧可以访问到 i
```

参考资料后解释如下：

- js中变量在函数及其嵌套函数内部都是有定义的，第二个 for 重新初始化了 i ，并不是因为第一个 i 是局部变量不影响第二个 i ，这个层次要搞清楚
- 在ES5中，无论在哪里定义的变量只要使用`var`定义，都会产生变量提升
- ES6之前只有全局和函数作用域，可通过匿名函数来模仿块级作用域
    
```javascript
(function() {
  for(var i=0;i<3;i++){fn1...}
})()
//把循环包在匿名函数里面执行之后就在函数中定义的变量就随着函数作用域销毁了，而且这个匿名函数是个闭包，不妨碍它能够访问到作用域中的其他变量
```

- ES5并不存在真正的块级作用域，此代码相当于

```javascript
var i =0;
while(i<3){
    fn1...
    i++
}
i=0;//重复的声明被忽略，事迹只是将 i 重新赋值为0
while(i<3){
    fn1...
    i++
}
//实际上两个 i 是同一个 i
```

- 考虑使用let声明变量

```javascript
for(let i = 0;i<3;i++){fn1...}
console.log(i)//访问不到 i
```